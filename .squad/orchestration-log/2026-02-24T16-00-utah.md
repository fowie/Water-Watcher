# Utah — Round 6

**Time:** 2026-02-24T16:00
**Role:** Backend
**Mode:** Background

## Task
Implement real authentication system replacing DEMO_USER_ID pattern.

## Output
- NextAuth.js v5 with Credentials provider and JWT session strategy.
- PBKDF2 password hashing (100K iterations, SHA-512) via `crypto.pbkdf2Sync`.
- Updated Prisma schema with auth models (Account, Session, VerificationToken).
- `withAuth()` middleware — validates session, injects `x-user-id` header, returns 401 on failure.
- `POST /api/auth/register` — Zod validation, duplicate-email check, password hashing, excludes passwordHash from response.
- Replaced all `DEMO_USER_ID` references with session-based user IDs.
- Route protection: public reads, auth-required writes, ownership-enforced deal filters.

## Decisions
BD-018
