# Utah — Round 14 Contributions

**Date:** 2026-02-26
**Round:** 14
**Agent:** Utah (Backend/Coordinator)

## Work Completed

1. **Content Security Policy (BD-040)** — Added comprehensive CSP header to `next.config.ts`. Strict `default-src 'self'`, Leaflet CDN allowance for styles, Open-Meteo and OAuth origins in `connect-src`, violation reporting to `POST /api/csp-report`. No `unsafe-eval`.

2. **ETag Caching (BD-041)** — Created `withETag(handler)` HOF in `web/src/lib/etag.ts`. MD5-based weak ETags, 304 Not Modified support, `Cache-Control: public, max-age=60, stale-while-revalidate=300`. Applied to 4 public GET endpoints. User-specific endpoints excluded.

3. **Input Sanitization (BD-042)** — Created `web/src/lib/sanitize.ts` with regex-based HTML stripping. Strips script/iframe/object tags, event handlers, javascript: URLs. Applied to review, trip, and photo caption fields. Runs after Zod validation, before DB write.

## Decisions Authored

- BD-040, BD-041, BD-042
